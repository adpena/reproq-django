<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reproq Django | Documentation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; }
        code, pre { font-family: 'JetBrains Mono', monospace; }
        .prose pre { background-color: #1e293b; color: #f8fafc; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; }
        .gradient-text { background: linear-gradient(135deg, #6366f1 0%, #a855f7 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 leading-relaxed">
    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-slate-200 hidden md:block sticky top-0 h-screen overflow-y-auto">
            <div class="p-6">
                <h1 class="text-2xl font-bold gradient-text">Reproq</h1>
                <p class="text-xs text-slate-500 font-semibold tracking-widest uppercase mt-1">Django Tasks</p>
            </div>
            <nav class="px-4 pb-6 space-y-1">
                <a href="#overview" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Overview</a>
                <a href="#quickstart" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Quickstart</a>
                <a href="#configuration" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Configuration</a>
                <div class="pt-4 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider px-3">Advanced</div>
                <a href="#lock-key" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Concurrency (Lock Key)</a>
                <a href="#workflows" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Workflows (Chains)</a>
                <a href="#periodic" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Periodic Tasks</a>
                <div class="pt-4 pb-2 text-xs font-semibold text-slate-400 uppercase tracking-wider px-3">Monitoring</div>
                <a href="#admin" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Dashboard & Admin</a>
                <a href="#metrics" class="block px-3 py-2 text-sm font-medium rounded-md hover:bg-slate-100 text-slate-700">Prometheus Metrics</a>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 max-w-4xl mx-auto px-6 py-12 md:px-12">
            <section id="overview" class="mb-16">
                <h2 class="text-4xl font-extrabold text-slate-900 mb-4 tracking-tight">Deterministic background tasks for Django.</h2>
                <p class="text-xl text-slate-600 mb-8">Reproq is a production-grade tasks backend that combines the ease of Django with the performance and reliability of a Go-based runner.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
                        <h3 class="font-bold text-indigo-600 mb-1">Postgres-Only</h3>
                        <p class="text-sm text-slate-500">No Redis or RabbitMQ required. Uses SKIP LOCKED for high-performance claiming.</p>
                    </div>
                    <div class="p-4 bg-white border border-slate-200 rounded-xl shadow-sm">
                        <h3 class="font-bold text-indigo-600 mb-1">Deterministic</h3>
                        <p class="text-sm text-slate-500">Stable spec hashing ensures you never run the same job twice unintentionally.</p>
                    </div>
                </div>
            </section>

            <section id="quickstart" class="mb-16 prose prose-slate max-w-none">
                <h2 class="text-3xl font-bold mb-6">Quickstart</h2>
                <p>Install the package and bootstrap the environment in three steps.</p>
                
                <h4 class="font-bold mt-4">1. Install</h4>
                <pre>pip install reproq-django</pre>

                <h4 class="font-bold mt-4">2. Bootstrap</h4>
                <p>Run the interactive init command to download the Go worker and check your settings.</p>
                <pre>python manage.py reproq init</pre>

                <h4 class="font-bold mt-4">3. Configure</h4>
                <p>Add to <code>INSTALLED_APPS</code> and set your <code>TASKS</code> backend.</p>
                <pre>TASKS = {
    "default": {
        "BACKEND": "reproq_django.backend.ReproqBackend",
    }
}</pre>
            </section>

            <section id="lock-key" class="mb-16 prose prose-slate max-w-none">
                <h2 class="text-3xl font-bold mb-6">Concurrency Control</h2>
                <p>Prevent multiple tasks from operating on the same resource simultaneously using <code>lock_key</code>.</p>
                <pre>from django.tasks import task

@task
def process_invoice(invoice_id):
    # Logic here
    pass

# This ensures only one invoice_123 task runs at a time
process_invoice.enqueue(123, lock_key="invoice_123")</pre>
            </section>

            <section id="workflows" class="mb-16 prose prose-slate max-w-none">
                <h2 class="text-3xl font-bold mb-6">Workflows</h2>
                <p>Reproq supports powerful task orchestration including Chains (sequential) and Groups (parallel).</p>
                <pre>from reproq_django.workflows import chain, group

# Sequential Execution
chain(task_a, task_b, task_c).enqueue()

# Parallel Execution
group(task_1, task_2, task_3).enqueue()</pre>
            </section>

            <section id="admin" class="mb-16">
                <h2 class="text-3xl font-bold mb-6">Real-Time Dashboard</h2>
                <p class="text-slate-600 mb-4">Reproq includes a high-performance dashboard built into the Django Admin. Monitor worker health, task duration, and execution success in real-time.</p>
                <div class="bg-slate-900 rounded-xl p-8 text-center text-white shadow-2xl">
                    <div class="text-indigo-400 font-bold mb-2 uppercase tracking-widest text-xs">Live Dashboard Features</div>
                    <ul class="text-left space-y-2 text-sm inline-block">
                        <li class="flex items-center"><span class="w-2 h-2 bg-green-500 rounded-full mr-2"></span> Auto-refreshing Task List (10s)</li>
                        <li class="flex items-center"><span class="w-2 h-2 bg-blue-500 rounded-full mr-2"></span> Worker Heartbeat Monitoring</li>
                        <li class="flex items-center"><span class="w-2 h-2 bg-purple-500 rounded-full mr-2"></span> Bulk Replay & Cancellation</li>
                        <li class="flex items-center"><span class="w-2 h-2 bg-indigo-500 rounded-full mr-2"></span> Visual Execution Timelines</li>
                    </ul>
                </div>
            </section>

            <footer class="mt-24 pt-8 border-t border-slate-200 text-slate-400 text-sm flex justify-between">
                <div>&copy; 2025 Alejandro Pe√±a. Released under MIT License.</div>
                <div class="flex space-x-4">
                    <a href="https://github.com/adpena/reproq-django" class="hover:text-indigo-500">GitHub</a>
                </div>
            </footer>
        </main>
    </div>
</body>
</html>
